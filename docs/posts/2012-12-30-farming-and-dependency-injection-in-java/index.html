<p>It's always good to revisit topics that you already touched before, the chance is that you will find out new things or remember forgotten ones.</p><p>So while I go over <a href="http://www.manning.com/evans/" target="_blank" rel="noopener noreferrer">The Well-Grounded Java Developer</a>, I intend posting here my own examples on different topics and techniques covered there.</p><h4 id="dependency_injection" tabindex="-1">Dependency Injection</h4><a class="direct-link" href="#dependency_injection"><span class="visually-hidden">Permalink to “Dependency Injection”</span> <span aria-hidden="true"></span></a><p>Today, the theme is going to be Dependency Injection. You probably know that there's a specification for this, namely <a href="http://www.jcp.org/en/jsr/detail?id=330" target="_blank" rel="noopener noreferrer">JSR-330</a> and you surely know what Dependency Injection is (let's call it DI from now on).</p><p>If not, to put it short, DI allows you make your classes and their dependencies loosely coupled. Let's say you have the class Company which has one Employee:</p><p>In this case, the Company is forced to use all the time the same type of Employee. You cannot easily 'hire' in place an ExperiencedDeveloper, subclass of Employee, without changing the whole Company. So what if we could inject any kind of Employee into the Company, without affecting the logic of the Company?</p><p>The simplest DI example is the constructor which gets an instance of the dependency class:</p><p>But wouldn't be nice to have something to take care for you of instantiating your dependencies? That's where Inversion of Control containers come in, the favorite of the day: <a href="http://code.google.com/p/google-guice/" target="_blank" rel="noopener noreferrer">Google Guice</a></p><h4 id="farming_with_guice" tabindex="-1">Farming with Guice</h4><a class="direct-link" href="#farming_with_guice"><span class="visually-hidden">Permalink to “Farming with Guice”</span> <span aria-hidden="true"></span></a><p>By the way, <a href="http://code.google.com/p/google-guice/" target="_blank" rel="noopener noreferrer">Google Guice</a> is the Reference Implementation for the <code>JSR-330 Dependency Injection in Java</code> specification so if you want something more advanced you might want to take a look at <a href="http://www.springsource.org/spring-framework" target="_blank" rel="noopener noreferrer">Spring</a> and <a href="http://picocontainer.codehaus.org/" target="_blank" rel="noopener noreferrer">PicoContainer</a>.</p><p>These being said, let's go to our example. Let's say we have a <em>Farmer</em>, who has a <em>Farm</em> and a <em>Land</em>. Every year he works the land and he gets _Crop_s. But the _Crop_s he gets depend on the type of <em>Weather</em> he has and the <em>Weather</em> is controlled by God. So we can safely say (figuratively speaking), that God injects the <em>Weather</em> in his <em>Farm</em>. And the <em>Farmer</em> would have to manage with whatever he gets, right?</p><p>Let's put this into code! The complete project can be found <a href="https://github.com/alexchiri/FarmingDependencyInjection" target="_blank" rel="noopener noreferrer">here</a> on my <a href="https://github.com/" target="_blank" rel="noopener noreferrer">GitHub</a> account.</p><p>So we have a <em>Farm</em>:</p><p>Notice the <code>@Inject</code> annotation before the constructor, that will inject our <em>Weather</em> into our <em>Farm</em>. Here's the <em>Weather</em> interface which has 3 implementations(DryWeather, MildWeather and WetWeather):</p><p>You probably guessed, different weather implementation, different types of _Crop_s in different quantities. But who says what <em>Weather</em> should be injected and from were? We would need a <code>com.google.inject.AbstractModule</code> implementation for that. In our case, the <em>Land</em>:</p><p>The <em>Land</em> says that a <code>com.google.inject.Provider</code>, in our case <em>GodFactor</em>, is responsible for providing our needed <em>Weather</em> instances:</p><p>I'm not sure God makes his decisions this way, but for this case let's say that the type of <em>Weather</em> is decided considering a random number and it's rest after the division by 3.</p><p>The last important piece in our little experiment is the <em>Farmer</em>. How does he manage his <em>Farm</em>?</p><p>The first thing he must do is get the <code>Injector</code> from <a href="http://code.google.com/p/google-guice/" target="_blank" rel="noopener noreferrer">Guice</a> and use it to get an instance to its <em>Farm</em> and then collect the _Crop_s. So if we run this nice <em>Farm</em> for 5 years (the rest of the classes I didn't present, <em>Weather</em> subclasses and <em>Crop</em>, you can see on the <a href="https://github.com/alexchiri/FarmingDependencyInjection" target="_blank" rel="noopener noreferrer">GitHub repo</a>) we would get something like this:</p><p>But wait, our poor <em>Farmer</em> gets a different <em>Farm</em> each year and also the <em>Weather</em> is totally different! That's not normal! Fortunately, we can do something about that. We can set the Scope of the DI to be Singleton, the only implementation of the Scope class. <strong>(Web apps get SESSION and REQUEST scopes as well, but those are in a special jar from <a href="http://code.google.com/p/google-guice/" target="_blank" rel="noopener noreferrer">Guice</a> with web components.)</strong><br>In order to do this, we modify the <em>Land</em> class:</p><p>Run it now and you get an output similar to this:</p><p>And that would be the end of my little farming with <a href="http://code.google.com/p/google-guice/" target="_blank" rel="noopener noreferrer">Guice</a> experiment. I hope it helps to easily understand which are the components needed to use DI and which is their role. This example could have been done in a number of other ways, but I let you to discover which are those. :)</p><p>You can read much more about DI online, there are plenty of resources, a Google search away, or to get started you can check out the <a href="http://www.manning.com/evans/" target="_blank" rel="noopener noreferrer">The Well-Grounded Java Developer</a> book.</p>